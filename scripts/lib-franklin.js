function assignTreatmentByVisitor(experimentid,identityId,allocationPercentages,treatments){var bucketId=function(saltedId){var hash=function(key,seed){for(var k1,h1b,remainder=3&key.length,bytes=key.length-remainder,c1=3432918353,c2=461845907,h1=seed,i=0;i<bytes;)k1=255&key.charCodeAt(i)|(255&key.charCodeAt(++i))<<8|(255&key.charCodeAt(++i))<<16|(255&key.charCodeAt(++i))<<24,++i,h1=27492+(65535&(h1b=5*(65535&(h1=(h1^=k1=(65535&(k1=(k1=(65535&k1)*c1+(((k1>>>16)*c1&65535)<<16)&4294967295)<<15|k1>>>17))*c2+(((k1>>>16)*c2&65535)<<16)&4294967295)<<13|h1>>>19))+((5*(h1>>>16)&65535)<<16)&4294967295))+((58964+(h1b>>>16)&65535)<<16);switch(k1=0,remainder){case 3:k1^=(255&key.charCodeAt(i+2))<<16;case 2:k1^=(255&key.charCodeAt(i+1))<<8;case 1:h1^=k1=(65535&(k1=(k1=(65535&(k1^=255&key.charCodeAt(i)))*c1+(((k1>>>16)*c1&65535)<<16)&4294967295)<<15|k1>>>17))*c2+(((k1>>>16)*c2&65535)<<16)&4294967295}return h1^=key.length,h1=2246822507*(65535&(h1^=h1>>>16))+((2246822507*(h1>>>16)&65535)<<16)&4294967295,h1=3266489909*(65535&(h1^=h1>>>13))+((3266489909*(h1>>>16)&65535)<<16)&4294967295,(h1^=h1>>>16)>>>0}(saltedId,0);return Math.abs(hash)%1e4/1e4}(experimentid+"."+identityId),treatmentId=function(allocationPercentages,treatments,bucket){for(var sum=allocationPercentages.reduce((function(partialSum,a){return partialSum+a}),0),partialSum=0,i=0;i<treatments.length;i++)if(!(bucket>(partialSum+=Number(allocationPercentages[i].toFixed(2))/sum)))return treatments[i]}(allocationPercentages,treatments,bucketId);return{treatmentId:treatmentId,bucketId:bucketId}}function assignTreatmentByDevice(experimentId,allocationPercentages,treatments){var treatmentIdResponse,cachedTreatmentId=function(experimentId){var experimentsStr=localStorage.getItem("unified-decisioning-experiments");if(experimentsStr){var experiments=JSON.parse(experimentsStr);if(experiments[experimentId])return experiments[experimentId].treatment}return null}(experimentId);if(cachedTreatmentId)treatmentIdResponse=cachedTreatmentId;else{var assignedTreatmentId=function(allocationPercentages,treatments){for(var random=100*Math.random(),i=treatments.length;random>0&&i>0;)random-=+allocationPercentages[i-=1];return treatments[i]}(allocationPercentages,treatments);!function(experimentId,treatment){var experimentsStr=localStorage.getItem("unified-decisioning-experiments"),experiments=experimentsStr?JSON.parse(experimentsStr):{},now=new Date;Object.keys(experiments).forEach((function(key){var date=new Date(experiments[key].date);now.getTime()-date.getTime()>2592e6&&delete experiments[key]}));var date=now.toISOString().split("T")[0];experiments[experimentId]={treatment:treatment,date:date},localStorage.setItem("unified-decisioning-experiments",JSON.stringify(experiments))}(experimentId,assignedTreatmentId),treatmentIdResponse=assignedTreatmentId}return{treatmentId:treatmentIdResponse}}var RandomizationUnit_VISITOR="VISITOR",RandomizationUnit_DEVICE="DEVICE";function traverseDecisionTree(decisionNodesMap,context,currentNodeId){var _a=decisionNodesMap[currentNodeId],experiment=_a.experiment;if("EXPERIMENTATION"===_a.type){var treatment=function(context,experiment){var experimentId=experiment.id,identityNamespace=experiment.identityNamespace,_a=experiment.randomizationUnit,randomizationUnit=void 0===_a?RandomizationUnit_VISITOR:_a,identityMap=context.identityMap,treatments=experiment.treatments.map((function(item){return item.id})),allocationPercentages=experiment.treatments.map((function(item){return item.allocationPercentage})),treatmentAssignment=null;switch(randomizationUnit){case RandomizationUnit_VISITOR:treatmentAssignment=assignTreatmentByVisitor(experimentId,identityMap[identityNamespace][0].id,allocationPercentages,treatments);break;case RandomizationUnit_DEVICE:treatmentAssignment=assignTreatmentByDevice(experimentId,allocationPercentages,treatments);break;default:throw new Error("Unknow randomization unit")}return{experimentId:experimentId,hashedBucket:treatmentAssignment.bucketId,treatment:{id:treatmentAssignment.treatmentId}}}(context,experiment).treatment;return[treatment]}}export function getMetadata(name){const attr=name&&name.includes(":")?"property":"name";return[...document.head.querySelectorAll(`meta[${attr}="${name}"]`)].map((m=>m.content)).join(", ")||""}export function toClassName(name){return"string"==typeof name?name.toLowerCase().replace(/[^0-9a-z]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}export function toCamelCase(name){return toClassName(name).replace(/-([a-z])/g,(g=>g[1].toUpperCase()))}export function readBlockConfig(block){const config={};return block.querySelectorAll(":scope>div").forEach((row=>{if(row.children){const cols=[...row.children];if(cols[1]){const col=cols[1],name=toClassName(cols[0].textContent);let value="";if(col.querySelector("a")){const as=[...col.querySelectorAll("a")];value=1===as.length?as[0].href:as.map((a=>a.href))}else if(col.querySelector("img")){const imgs=[...col.querySelectorAll("img")];value=1===imgs.length?imgs[0].src:imgs.map((img=>img.src))}else if(col.querySelector("p")){const ps=[...col.querySelectorAll("p")];value=1===ps.length?ps[0].textContent:ps.map((p=>p.textContent))}else value=row.children[1].textContent;config[name]=value}}})),config}export const RumPlugin=()=>{function sampleRUM(checkpoint,data={}){sampleRUM.defer=sampleRUM.defer||[];const defer=fnname=>{sampleRUM[fnname]=sampleRUM[fnname]||((...args)=>sampleRUM.defer.push({fnname:fnname,args:args}))};sampleRUM.drain=sampleRUM.drain||((dfnname,fn)=>{sampleRUM[dfnname]=fn,sampleRUM.defer.filter((({fnname:fnname})=>dfnname===fnname)).forEach((({fnname:fnname,args:args})=>sampleRUM[fnname](...args)))}),sampleRUM.on=(chkpnt,fn)=>{sampleRUM.cases[chkpnt]=fn},defer("observe"),defer("cwv");try{if(window.hlx=window.hlx||{},!window.hlx.rum){const weight="on"===new URLSearchParams(window.location.search).get("rum")?1:100,id=`${(s=>s.split("").reduce(((a,b)=>(a<<5)-a+b.charCodeAt(0)|0),0))(window.location.href)}-${(new Date).getTime()}-${Math.random().toString(16).substr(2,14)}`,random=Math.random(),isSelected=random*weight<1;window.hlx.rum={weight:weight,id:id,random:random,isSelected:isSelected,sampleRUM:sampleRUM}}const{weight:weight,id:id}=window.hlx.rum;if(window.hlx&&window.hlx.rum&&window.hlx.rum.isSelected){const sendPing=(pdata=data)=>{const body=JSON.stringify({weight:weight,id:id,referer:window.location.href,generation:window.hlx.RUM_GENERATION,checkpoint:checkpoint,...data}),url=`https://rum.hlx.page/.rum/${weight}`;navigator.sendBeacon(url,body),console.debug(`ping:${checkpoint}`,pdata)};sampleRUM.cases=sampleRUM.cases||{cwv:()=>sampleRUM.cwv(data)||!0,lazy:()=>{const script=document.createElement("script");return script.src="https://rum.hlx.page/.rum/@adobe/helix-rum-enhancer@^1/src/index.js",document.head.appendChild(script),!0}},sendPing(data),sampleRUM.cases[checkpoint]&&sampleRUM.cases[checkpoint]()}}catch(error){}}return sampleRUM("top"),window.addEventListener("load",(()=>sampleRUM("load"))),{name:"rum",api:{sampleRUM:sampleRUM},preEager:async()=>{window.addEventListener("unhandledrejection",(event=>{sampleRUM("error",{source:event.reason.sourceURL,target:event.reason.line})})),window.addEventListener("error",(event=>{sampleRUM("error",{source:event.filename,target:event.lineno})}))},postLazy:async()=>{const main=document.querySelector("main");sampleRUM("lazy"),sampleRUM.observe(main.querySelectorAll("div[data-block-name]")),sampleRUM.observe(main.querySelectorAll("picture > img"))},preDelayed:async()=>{sampleRUM("cwv")}}};export const DecoratorPlugin=()=>{function decorateBlock(block){const shortBlockName=block.classList[0];if(shortBlockName){block.classList.add("block"),block.setAttribute("data-block-name",shortBlockName),block.setAttribute("data-block-status","initialized");block.parentElement.classList.add(`${shortBlockName}-wrapper`);const section=block.closest(".section");section&&section.classList.add(`${shortBlockName}-container`)}}return{name:"decorator",api:{decorateBlock:decorateBlock,decorateButtons:function(element){element.querySelectorAll("a").forEach((a=>{if(a.title=a.title||a.textContent,a.href!==a.textContent){const up=a.parentElement,twoup=a.parentElement.parentElement;a.querySelector("img")||(1!==up.childNodes.length||"P"!==up.tagName&&"DIV"!==up.tagName||(a.className="button primary",up.classList.add("button-container")),1===up.childNodes.length&&"STRONG"===up.tagName&&1===twoup.childNodes.length&&"P"===twoup.tagName&&(a.className="button primary",twoup.classList.add("button-container")),1===up.childNodes.length&&"EM"===up.tagName&&1===twoup.childNodes.length&&"P"===twoup.tagName&&(a.className="button secondary",twoup.classList.add("button-container")))}}))},decorateIcons:function(element=document){element.querySelectorAll("span.icon").forEach((async span=>{if(span.classList.length<2||!span.classList[1].startsWith("icon-"))return;const icon=span.classList[1].substring(5),resp=await fetch(`${window.hlx.codeBasePath}/icons/${icon}.svg`);if(resp.ok){const iconHTML=await resp.text();if(iconHTML.match(/<style/i)){const img=document.createElement("img");img.src=`data:image/svg+xml,${encodeURIComponent(iconHTML)}`,span.appendChild(img)}else span.innerHTML=iconHTML}}))}},preEager:async()=>{!function(){const addClasses=(elem,classes)=>{classes.split(",").forEach((v=>{elem.classList.add(toClassName(v.trim()))}))},template=getMetadata("template");template&&addClasses(document.body,template);const theme=getMetadata("theme");theme&&addClasses(document.body,theme)}()},postEager:async()=>{const main=document.querySelector("main");!function(main){main.querySelectorAll(":scope > div").forEach((section=>{const wrappers=[];let defaultContent=!1;[...section.children].forEach((e=>{if("DIV"===e.tagName||!defaultContent){const wrapper=document.createElement("div");wrappers.push(wrapper),defaultContent="DIV"!==e.tagName,defaultContent&&wrapper.classList.add("default-content-wrapper")}wrappers[wrappers.length-1].append(e)})),wrappers.forEach((wrapper=>section.append(wrapper))),section.classList.add("section"),section.setAttribute("data-section-status","initialized");const sectionMeta=section.querySelector("div.section-metadata");if(sectionMeta){const meta=readBlockConfig(sectionMeta);Object.keys(meta).forEach((key=>{"style"===key?meta.style.split(",").map((style=>toClassName(style.trim()))).forEach((style=>section.classList.add(style))):section.dataset[toCamelCase(key)]=meta[key]})),sectionMeta.parentNode.remove()}}))}(main),function(main){main.querySelectorAll("div.section > div > div").forEach(decorateBlock)}(main)}}};export const ExperimentationPlugin=()=>{const DEFAULT_OPTIONS={basePath:"/experiments",configFile:"manifest.json",metaTag:"experiment",queryParameter:"experiment",storeKey:"hlx-experiments"};async function getExperimentConfig(experimentId,cfg){const path=`${cfg.basePath}/${experimentId}/${cfg.configFile}`;try{const resp=await fetch(path);if(!resp.ok)return console.log("error loading experiment config:",resp),null;const json=await resp.json(),config=cfg.parser?cfg.parser(json):function(json){const config={};try{return json.settings.data.forEach((row=>{const prop=toCamelCase(row.Name);["audience","status"].includes(prop)?config[prop]=row.Value:"experimentName"===prop?config.label=row.Value:"blocks"===prop&&(config[prop]=row.Value.split(/[,\n]/))})),config.variantNames=[],config.variants={},json.variants.data.forEach((row=>{const{Name:Name,Label:Label,Split:Split,Pages:Pages,Blocks:Blocks}=row,variantName=toCamelCase(Name);config.variantNames.push(variantName),config.variants[variantName]={label:Label,percentageSplit:Split,content:Pages?Pages.trim().split(","):[],code:Blocks?Blocks.trim().split(","):[]}})),config}catch(e){console.log("error parsing experiment config:",e)}return null}(json);return function(config){if(!config.variantNames||!config.variants||!Object.values(config.variants).every((v=>!("object"!=typeof v||!v.code||!v.content||""!==v.percentageSplit&&!v.percentageSplit))))throw new Error("Invalid experiment config. Please review your sheet and parser.")}(config),config.id=experimentId,config.manifest=path,config.basePath=`${cfg.basePath}/${experimentId}`,config}catch(e){console.log(`error loading experiment manifest: ${path}`,e)}return null}async function runExperiment(config,plugins){const experiment=(tagName=config.metaTag,navigator.userAgent.match(/bot|crawl|spider/i)?null:toClassName(getMetadata(tagName))||null);var tagName;if(!experiment)return;const usp=new URLSearchParams(window.location.search),[forcedExperiment,forcedVariant]=usp.has(config.queryParameter)?usp.get(config.queryParameter).split("/"):[],experimentConfig=await getExperimentConfig(experiment,config);if(console.debug(experimentConfig),!experimentConfig||"active"!==toCamelCase(experimentConfig.status)&&!forcedExperiment)return;var audience,decisionPolicy,context,decisionNodesMap;if(experimentConfig.run=forcedExperiment||("mobile"===(audience=toClassName(experimentConfig.audience))?window.innerWidth<600:"desktop"!==audience||window.innerWidth>=600),window.hlx=window.hlx||{},window.hlx.experiment=experimentConfig,console.debug("run",experimentConfig.run,experimentConfig.audience),!experimentConfig.run)return;if(forcedVariant&&experimentConfig.variantNames.includes(forcedVariant))experimentConfig.selectedVariant=forcedVariant;else{const decision=(decisionPolicy=function(config){return{id:"content-experimentation-policy",rootDecisionNodeId:"n1",decisionNodes:[{id:"n1",type:"EXPERIMENTATION",experiment:{id:config.id,identityNamespace:"ECID",randomizationUnit:"DEVICE",treatments:Object.entries(config.variants).map((([key,props])=>({id:key,allocationPercentage:props.percentageSplit?100*parseFloat(props.percentageSplit):100-Object.values(config.variants).reduce(((result,variant)=>result-100*parseFloat(variant.percentageSplit||0)),100)})))}}]}}(experimentConfig),context={},decisionNodesMap={},decisionPolicy.decisionNodes.forEach((function(item){decisionNodesMap[item.id]=item})),{items:traverseDecisionTree(decisionNodesMap,context,decisionPolicy.rootDecisionNodeId)});experimentConfig.selectedVariant=decision.items[0].id}if(plugins.rum&&plugins.rum.sampleRUM("experiment",{source:experimentConfig.id,target:experimentConfig.selectedVariant}),console.debug(`running experiment (${window.hlx.experiment.id}) -> ${window.hlx.experiment.selectedVariant}`),experimentConfig.selectedVariant===experimentConfig.variantNames[0])return;const currentPath=window.location.pathname,{content:content}=experimentConfig.variants[experimentConfig.selectedVariant];if(!content.length)return;const index=experimentConfig.variants[experimentConfig.variantNames[0]].content.indexOf(currentPath);index<0||content[index]===currentPath||await async function(path,element,isBlock=!1){const plainPath=`${path}.plain.html`;try{const resp=await fetch(plainPath);if(!resp.ok)return console.log("error loading experiment content:",resp),null;const html=await resp.text();if(isBlock){const div=document.createElement("div");div.innerHTML=html,element.replaceWith(div.children[0].children[0])}else element.innerHTML=html}catch(e){console.log(`error loading experiment content: ${plainPath}`,e)}return null}(content[0],document.querySelector("main"))}return{name:"experimentation",patchBlockConfig:config=>{const{experiment:experiment}=window.hlx;if(!experiment||!experiment.run)return config;if(experiment.selectedVariant===experiment.variantNames[0]||!experiment.blocks||!experiment.blocks.includes(config.blockName))return config;const variant=experiment.variants[experiment.selectedVariant];if(!variant.code.length)return config;let index=experiment.variants[experiment.variantNames[0]].code.indexOf("");if(index<0&&(index=experiment.variants[experiment.variantNames[0]].code.indexOf(config.blockName)),index<0&&(index=experiment.variants[experiment.variantNames[0]].code.indexOf(`/blocks/${config.blockName}`)),index<0)return config;let path,origin="";if(/^https?:\/\//.test(variant.code[index])){const url=new URL(variant.code[index]);url.origin!==window.location.origin&&(origin=url.origin),path="/"!==url.pathname?url.pathname:`/blocks/${config.blockName}`}else path=variant.code[index];if(!origin&&!path)return config;const{codeBasePath:codeBasePath}=window.hlx;return{...config,cssPath:`${origin}${codeBasePath}${path}/${config.blockName}.css`,jsPath:`${origin}${codeBasePath}${path}/${config.blockName}.js`}},preEager:async(customOptions,plugins)=>{const options={...DEFAULT_OPTIONS,...customOptions};var n;await runExperiment(options,plugins),n=window,["alloy"].forEach((function(o){n[o]||((n.__alloyNS=n.__alloyNS||[]).push(o),n[o]=function(){var u=arguments;return new Promise((function(i,l){n[o].q.push([i,l,u])}))},n[o].q=[])}))},preLazy:async()=>{import("./plugins/experimentation-ued/alloy.min.js"),(window.location.hostname.endsWith("hlx.page")||"localhost"===window.location.hostname)&&import("./plugins/experimentation-ued/preview.js")}}};export function loadCSS(href,callback){if(document.querySelector(`head > link[href="${href}"]`))"function"==typeof callback&&callback("noop");else{const link=document.createElement("link");link.setAttribute("rel","stylesheet"),link.setAttribute("href",href),"function"==typeof callback&&(link.onload=e=>callback(e.type),link.onerror=e=>callback(e.type)),document.head.appendChild(link)}}const pluginReferences={},pluginsApis={};export async function withPlugin(pathOrFunction,options={}){let plugin,pluginName;if("string"==typeof pathOrFunction){const tokens=pathOrFunction.split("/");pluginName=toCamelCase(tokens.pop().replace(".js","")),"index"===pluginName&&(pluginName=toCamelCase(tokens.pop())),plugin=await import(pathOrFunction)}else{if("function"!=typeof pathOrFunction)throw new Error("Invalid plugin reference",pathOrFunction);plugin=pathOrFunction(options),pluginName=plugin.name||pathOrFunction.name}return pluginReferences[pluginName]={...plugin,options:options},plugin.api&&(pluginsApis[pluginName]=plugin.api),plugin.api||null}export const plugins=pluginsApis;export function buildBlock(blockName,content){const table=Array.isArray(content)?content:[[content]],blockEl=document.createElement("div");return blockEl.classList.add(blockName),table.forEach((row=>{const rowEl=document.createElement("div");row.forEach((col=>{const colEl=document.createElement("div");(col.elems?col.elems:[col]).forEach((val=>{val&&("string"==typeof val?colEl.innerHTML+=val:colEl.appendChild(val))})),rowEl.appendChild(colEl)})),blockEl.appendChild(rowEl)})),blockEl}export function createOptimizedPicture(src,alt="",eager=!1,breakpoints=[{media:"(min-width: 400px)",width:"2000"},{width:"750"}]){const url=new URL(src,window.location.href),picture=document.createElement("picture"),{pathname:pathname}=url,ext=pathname.substring(pathname.lastIndexOf(".")+1);return breakpoints.forEach((br=>{const source=document.createElement("source");br.media&&source.setAttribute("media",br.media),source.setAttribute("type","image/webp"),source.setAttribute("srcset",`${pathname}?width=${br.width}&format=webply&optimize=medium`),picture.appendChild(source)})),breakpoints.forEach(((br,i)=>{if(i<breakpoints.length-1){const source=document.createElement("source");br.media&&source.setAttribute("media",br.media),source.setAttribute("srcset",`${pathname}?width=${br.width}&format=${ext}&optimize=medium`),picture.appendChild(source)}else{const img=document.createElement("img");img.setAttribute("loading",eager?"eager":"lazy"),img.setAttribute("alt",alt),picture.appendChild(img),img.setAttribute("src",`${pathname}?width=${br.width}&format=${ext}&optimize=medium`)}})),picture}export function normalizeHeadings(el,allowedHeadings){const allowed=allowedHeadings.map((h=>h.toLowerCase()));el.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((tag=>{const h=tag.tagName.toLowerCase();if(-1===allowed.indexOf(h)){let level=parseInt(h.charAt(1),10)-1;for(;-1===allowed.indexOf(`h${level}`)&&level>0;)level-=1;if(0===level)for(;-1===allowed.indexOf(`h${level}`)&&level<7;)level+=1;7!==level&&(tag.outerHTML=`<h${level} id="${tag.id}">${tag.textContent}</h${level}>`)}}))}export function updateSectionsStatus(main){const sections=[...main.querySelectorAll(":scope>div")];for(let i=0;i<sections.length;i+=1){const section=sections[i];if("loaded"!==section.getAttribute("data-section-status")){if(section.querySelector('.block[data-block-status="initialized"], .block[data-block-status="loading"]')){section.setAttribute("data-section-status","loading");break}section.setAttribute("data-section-status","loaded")}}}export async function loadBlock(block){const status=block.getAttribute("data-block-status");if("loading"===status||"loaded"===status)return;block.setAttribute("data-block-status","loading");const{blockName:blockName,cssPath:cssPath,jsPath:jsPath}=function(block){const blockName=block.getAttribute("data-block-name"),cssPath=`${window.hlx.codeBasePath}/blocks/${blockName}/${blockName}.css`,jsPath=`${window.hlx.codeBasePath}/blocks/${blockName}/${blockName}.js`;return Object.values(pluginReferences).reduce(((config,plugin)=>plugin.patchBlockConfig?plugin.patchBlockConfig(config):config),{blockName:blockName,cssPath:cssPath,jsPath:jsPath})}(block);try{const cssLoaded=new Promise((resolve=>{loadCSS(cssPath,resolve)})),decorationComplete=new Promise((resolve=>{(async()=>{try{const mod=await import(jsPath);mod.default&&await mod.default(block,pluginsApis)}catch(error){console.log(`failed to load module for ${blockName}`,error)}resolve()})()}));await Promise.all([cssLoaded,decorationComplete])}catch(error){console.log(`failed to load block ${blockName}`,error)}block.setAttribute("data-block-status","loaded")}export async function loadBlocks(main){updateSectionsStatus(main);const blocks=[...main.querySelectorAll("div.block")];for(let i=0;i<blocks.length;i+=1)await loadBlock(blocks[i]),updateSectionsStatus(main)}export async function waitForLCP(lcpBlocks){const block=document.querySelector(".block");block&&lcpBlocks.includes(block.getAttribute("data-block-name"))&&await loadBlock(block),document.querySelector("body").classList.add("appear");const lcpCandidate=document.querySelector("main img");await new Promise((resolve=>{lcpCandidate&&!lcpCandidate.complete?(lcpCandidate.setAttribute("loading","eager"),lcpCandidate.addEventListener("load",resolve),lcpCandidate.addEventListener("error",resolve)):resolve()}))}export async function loadPage(options={}){const pluginsList=Object.values(pluginReferences);await Promise.all(pluginsList.map((p=>p.preEager&&p.preEager.call(null,p.options,pluginsApis)))),options.loadEager&&await options.loadEager(document,options),await Promise.all(pluginsList.map((p=>p.postEager&&p.postEager.call(null,p.options,pluginsApis)))),await waitForLCP(options.lcpBlocks||[]);const main=document.querySelector("main");return await loadBlocks(main),await Promise.all(pluginsList.map((p=>p.preLazy&&p.preLazy.call(null,p.options,pluginsApis)))),options.loadLazy&&await options.loadLazy(document,options),await Promise.all(pluginsList.map((p=>p.postLazy&&p.postLazy.call(null,p.options,pluginsApis)))),new Promise((resolve=>{window.setTimeout((async()=>{await Promise.all(pluginsList.map((p=>p.preDelayed&&p.preDelayed.call(null,p.options,pluginsApis)))),options.loadDelayed&&await options.loadDelayed(document,options),await Promise.all(pluginsList.map((p=>p.postDelayed&&p.postDelayed.call(null,p.options,pluginsApis)))),resolve()}),options.delayedDuration||3e3)}))}window.hlx=window.hlx||{},withPlugin(RumPlugin);const{decorateBlock:decorateBlock,decorateButtons:decorateButtons,decorateIcons:decorateIcons}=await withPlugin(DecoratorPlugin);export async function init(options){window.hlx.codeBasePath="";const scriptEl=document.querySelector('script[src$="/scripts/scripts.js"]');if(scriptEl)try{[window.hlx.codeBasePath]=new URL(scriptEl.src).pathname.split("/scripts/scripts.js")}catch(error){console.log(error)}return loadPage(options)}function buildAutoBlocks(main){try{!function(main){const h1=main.querySelector("h1"),picture=main.querySelector("picture");if(h1&&picture&&h1.compareDocumentPosition(picture)&Node.DOCUMENT_POSITION_PRECEDING){const section=document.createElement("div");section.append(buildBlock("hero",{elems:[picture,h1]})),main.prepend(section)}}(main)}catch(error){console.error("Auto Blocking failed",error)}}window.hlx.RUM_GENERATION="project-1",await withPlugin(ExperimentationPlugin,{basePath:"/franklin-experiments",configFile:"franklin-experiment.json",parser:json=>{const config={};try{const keyMap={"Experiment Name":"label"};return Object.values(json.settings.data).reduce(((cfg,entry)=>{const key=keyMap[entry.Name]||toCamelCase(entry.Name);return cfg[key]="blocks"===key?entry.Value.split(/[,\n]/):entry.Value,cfg}),config),config.variantNames=[],config.variants={},json.variants.data.forEach((row=>{const{Name:Name,Label:Label,Split:Split,Page:Page,Block:Block}=row,variantName=toCamelCase(Name);config.variantNames.push(variantName),config.variants[variantName]={label:Label,percentageSplit:Split,content:Page?Page.trim().split(","):[],code:Block?Block.trim().split(","):[]}})),config}catch(e){console.log("error parsing experiment config:",e)}return null}});export function decorateMain(main){decorateButtons(main),decorateIcons(main),buildAutoBlocks(main)}export function addFavIcon(href){const link=document.createElement("link");link.rel="icon",link.type="image/svg+xml",link.href=href;const existingLink=document.querySelector('head link[rel="icon"]');existingLink?existingLink.parentElement.replaceChild(link,existingLink):document.getElementsByTagName("head")[0].appendChild(link)}export function loadHeader(header){const headerBlock=buildBlock("header","");return header.append(headerBlock),decorateBlock(headerBlock),loadBlock(headerBlock)}export function loadFooter(footer){const footerBlock=buildBlock("footer","");return footer.append(footerBlock),decorateBlock(footerBlock),loadBlock(footerBlock)}init({loadEager:async function(doc){document.documentElement.lang="en";const main=doc.querySelector("main");main&&decorateMain(main)},loadLazy:async function(doc){const main=doc.querySelector("main"),{hash:hash}=window.location,element=!!hash&&main.querySelector(hash);hash&&element&&element.scrollIntoView(),loadHeader(doc.querySelector("header")),loadFooter(doc.querySelector("footer")),loadCSS(`${window.hlx.codeBasePath}/styles/lazy-styles.css`),addFavIcon(`${window.hlx.codeBasePath}/styles/favicon.svg`)},loadDelayed:function(){import("./delayed.js")},lcpblocks:[]});